<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.bitschool.gaverything.GradeMapper">
 	<insert id="insertNew" parameterType="GradeDTO">
		<selectKey keyProperty="gradeSeq" order="BEFORE" resultType="Integer">
			select grade_seq.nextval from dual
		</selectKey>
		insert into grade (gradeSeq,nickname) values(#{gradeSeq},#{nickname})
 	</insert>  

  	<insert id="insertInfo" parameterType="GradeDTO">
  		<selectKey keyProperty="gradeSeq" order="BEFORE" resultType="Integer">
			select grade_seq.nextval from dual
		</selectKey>
  		insert into grade (gradeSeq,nickname,type) 
  		values(#{gradeSeq},#{nickname},#{type})
  	</insert> 
  	
  	<!-- 한개 삭제  -->
  	<delete id="deleteInfo" parameterType="GradeDTO">
  		delete from grade where gradeSeq = 
		(select gradeSeq from 
		(select rownum as num, a.* from 
		(select * from grade 
		where nickname = #{nickname} and type = #{type} 
		order by gradeseq desc) a) b 
		where num = 1)
  	</delete>
 
 </mapper>